<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: fileHandler.js</title>
    
    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">
    
    <h1 class="page-title">Source: fileHandler.js</h1>
    
    


    
    <section>
        <article>
            <pre class="prettyprint source"><code>   /**
     * @fileOverview Various tool functions.
     * @version 3.1.2
     */



/**
 * Represents a book.
 * @function
 */

define(function (require, exports, module) {
	"use strict";

       /// Form to open a new set of files
       var newFileForm = require("pvsioweb/forms/newFileForm");   
	
       var formEvents = require("pvsioweb/forms/events");
	
       /// Reference to current project, main.js passes it by using fileHandler_setProject
       var currentProject;


/**
 * Represents a book.
 * @constructor
 */

function setProject(project)
{
	currentProject = project;

}


/** 
 * Create a new file, it is going to be shown in the listview: #pvsFiles  
 *  
 *  @param  name:    name of the file
 *  @param  content:   textual content of the file 
 *
 *  @returns void 
 *	      
 */
	
function new_file(name, content )
{
	var default_name = "MyTheory.pvs";
	var default_content = "MyTheory" + " THEORY BEGIN \nEND MyTheory" ;

	if( ! name ) { name = default_name; }
	
	if( ! content ) { content = default_content; }

    	currentProject.addSpecFile(default_name, default_content);
	renderSourceFileList(currentProject.pvsFiles());	
}


/** 
 *  Display new file form, invoke function open_file (see below)  
 *
 *  @returns void 
 *	      
 */
function open_file_form()
{
	newFileForm.create().addListener(formEvents.FormCancelled, function (e) {
			console.log(e);
			e.form.remove();
	}).addListener(formEvents.FormSubmitted, function (e) {
			console.log(e);
			e.form.remove();
			open(e.formJSON);
	});
	
}

/** 
 *  Open file specified in data, data must have this structure: ????  FIXME
 * 
 *  @param  data: ??? FIXME
 *
 *  @returns void 
 *	      
 */
function open_file(data)
{
	var q = queue(), i;
                
                
        for (i = 0; i &lt; data.pvsSpec.length; i++) {
            q.defer(createFileLoadFunction(data.pvsSpec[i]));
        }
        
        q.awaitAll(function (err, res) {
            currentProject.saveNew(function (err, res) {
                console.log({err: err, res: res});
               
                    renderSourceFileList(currentProject.pvsFiles());
 
            });
        });
			
}








/********* Exported Function ******************/
module.exports = {
	new_file: function (name, content) {
		return new_file(name, content);
	},
	open_file_form: function () {
		return open_file_form();
	},
	open_file: function () {
		return open_file();
	},
	setProject: function (project) {
		return setProject(project);
	}	

};

/***********************************************/


});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-dev</a> on Wed Oct 16 2013 21:04:28 GMT+0100 (BST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
